#!/usr/bin/env bash

set -euo pipefail

if hash bw 2>/dev/null && hash jq 2>/dev/null; then
  bw get item 00153365-5d2f-4639-908d-ad1b004b1da2 | jq --raw-output '.notes' >"$HOME/.zshenv.private"
  bw get item 3e24accf-02a5-4547-8d88-ad1b00075f68 | jq --raw-output '.notes' >"$HOME/.ssh/config"

  chmod go-rwx "$HOME/.zshenv.private" "$HOME/.ssh/config"

  if [[ "$(uname -a)" != *[Mm]icrosoft* ]]; then
    bw get item cb5916e1-4afb-492a-911f-adac01713907 | jq --raw-output '.notes' >"$HOME/.ddns-config.json"

    chmod go-rwx "$HOME/.ddns-config.json"
  fi
else
  fail "Need bitwarden-cli and jq tool"
fi
